# Provisioning Global Breadcrumb & Ribbon SharePoint Add-In #

### Summary ###
The Core.GlobalBreadcrumbRibbon solution provides a provision page to include Global Breadcrumb & Ribbon **(SharePoint or JSON Data)** in all sites and subsites associated to Site Collection. The **Custom Breadcrumb is able to Navigate betweeen all Site Collection Sites and sub folders where user is located**, the **Site Collection Navigation Breadcrumb if a custom Breadcrumb stored in RootWeb with JSON Data**. The Breadcrumb & Ribbon is available in all SharePoint Pages using an Scriptlink file stored in Site Collection, both features keep Minimal Download Strategy "MDS" enable.

### Applies to ###
-  Office 365 Multi Tenant (MT)
-  Office 365 Dedicated (D)
-  SharePoint 2013 on-premises

### Prerequisites ###
None

### Solution ###
Solution | Author(s)
---------|----------
Core.GlobalBreadcrumbRibbon| **Andr√© Lage**

### Version history ###
Version  | Date | Comments
---------| -----| --------
1.0  | Jun 12th 2015 | Initial release

### Disclaimer ###
**THIS CODE IS PROVIDED *AS IS* WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING ANY IMPLIED WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR NON-INFRINGEMENT.**


----------

# Instalation #
The Solution is an SharePoint Add-In that can be deployed in the app catalog site of the Tenant and then install in the SharePoint Site using "Add an app" Option.

## Provisioning Global Breadcrumb and Ribbon ##

The Add-in provides a Page to support the different steps of the provisioning and associated dependecies to include Global Breadcrumbs **(SharePoint or JSON Data)** & Ribbon in all Sites and Folders in the Site Collection.

![](http://i.imgur.com/eEaSbCE.png)

The Page has 2 buttons to support the provision.

- The Add provision option includes the Objects **"PropertyBag/JSON/JSFile/ScripLink"** in the RootHostWeb.
- The Remove provision option removes the Objects **"PropertyBag/JSON/ScripLink"** from the RootHostWeb.

### Provision Sequence ###
- PropertyBag **PnPGlobalBreadcrumbRibbon** is created in RootWeb of the SiteCollection, this item will have the following JSON data:
#### {"Breadcrumb": [{"title": "Home","description": "Home"},{"title": "Product Category","description": "Product Category"},{"title": "Product","description": "Product"},{"title": "Example","description": "Example"}]} ####
- A file from the AppWeb **PnPGlobal.js** is copied to folder **"_catalogs/masterpage/Display Template"**, the JS file includes the code for the creation of the Global Breadcrumb **(SharePoint or JSON Data)** & Ribbon. 
- A **ScriptLink** is created in **SiteCollection** with name **PnPGlobalBreadcrumbRibbon** and linked to JS file **PnPGlobal.js**.

![](http://i.imgur.com/9uRUT6H.png)

## Global Breadcrumb & Ribbon Add-In functionalities ##
- Global BreadCrumb **(SharePoint or JSON Data)** is included bellow the Ribbon Banner.
- Global Ribbon with custom Actions is included in the Ribbon Banner.

![](http://i.imgur.com/8jalZEb.png)

### Global Breadcrumb & Ribbon ###
- Minimal Download Strategy (MDS).
- Breadcumb is generated by **SharePoint Data** or **JSON** stored in **"RootWeb" propertybag "PnPGlobalBreadcrumbRibbon"**
- Global Breadcumb & Ribbon are available in Sub Sites of the Site Collection.
- Ribbons Custom Actions can be included in the Global Ribbon.

![](http://i.imgur.com/bEF5uHX.png)


### Support Links for some actions: ###
**SP Ribbon Objects**
[https://paulbuzzblog.wordpress.com/2012/11/23/how-to-hide-the-sharepoint-ribbon/](https://paulbuzzblog.wordpress.com/2012/11/23/how-to-hide-the-sharepoint-ribbon/)

**Provision Files AppWeb to HostWeb**
[http://www.sharepointnutsandbolts.com/2013/05/sp2013-host-web-apps-provisioning-files.html](http://www.sharepointnutsandbolts.com/2013/05/sp2013-host-web-apps-provisioning-files.html)